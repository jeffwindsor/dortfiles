#!/usr/bin/env bash

# Aliases
alias ....='cd ../../../'
alias ...='cd ../../'
alias ..='cd ..'
alias business="cd \$SRC/github.com/jeffwindsor/financials/gnucash/business/imports"
alias home="cd \$SRC/github.com/jeffwindsor/financials/gnucash/home/imports"
alias hub="cd \$SRC/github.com"
alias jeff="cd \$SRC/github.com/jeffwindsor/"
alias md="cd \$HOME/portable/exocortex/markdown"
alias src="cd \$SRC && lla"
alias icloud="cd \$HOME/Library/Mobile\\ Documents/com~apple~CloudDocs/Documents"

if command -v bat &>/dev/null; then
	alias cat='bat --style=plain'
fi

if command -v eza &>/dev/null; then
	alias l='eza -F --group-directories-first'
	alias la='eza -F --group-directories-first --git --all'
	alias ll='eza -lF --group-directories-first'
	alias lla='eza -lF --group-directories-first --git --all'
	alias tree='eza --tree --git'
	alias treea='eza -lF --tree --git --all'
else
	alias l='ls'
	alias la='ls -a'
	alias ll='ls -l'
	alias lla='ls -la'
fi

if command -v freshfetch &>/dev/null; then
	alias f='freshfetch'
fi

if command -v fzf &>/dev/null; then
	alias theme='wezterm-theme'
	function wezterm-theme() {
		local result
		result=$(fzf <"$XDG_CONFIG_HOME"/wezterm/color_schemes.txt)
		[ -n "$result" ] && sd '^config.color_scheme.*$' "config.color_scheme = '${result}'" "$XDG_CONFIG_HOME"/wezterm/wezterm.lua
	}
fi

if command -v git &>/dev/null; then
	# prompt user to select from list of git directories under $2 and if user selects one, execute command $1 on it
	function exec-on-git-repos() {
		local result
		result=$(git-find-dirs "$2" | fzf --reverse)
		[ -n "$result" ] && "$1" "$result" && lla
	}
	alias hubs="exec-on-git-repos cd \$SRC/github.com/"
	alias srcs="exec-on-git-repos cd \$SRC"

	# git clone from git hub to my source directory
	function ghc() { git clone git@github.com:"$1" "$SRC"/github.com/"$1"; }

fi

if command -v hx &>/dev/null; then
	alias h='hx'
	alias hexo='hx ~/portable/exocortex'
	alias hfins="nvim -c \":Telescope find_files cwd=\$HOME/portable/financials\""
	alias hconfigs="nvim -c \":Telescope find_files cwd=\$XDG_CONFIG_HOME\""
	alias hdots="yadm list --all | fzf | xargs nvim"

fi

if command -v lazygit &>/dev/null; then
	alias lg=lazygit
fi

if command -v nvim &>/dev/null; then

	alias v='nvim'
	alias v.='nvim .'
	alias vv="nvim -c \":Telescope find_files cwd=\$HOME/.config/nvim/lua/custom\""
	alias fins="nvim -c \":Telescope find_files cwd=\$HOME/portable/financials\""
	alias dots="yadm list --all | fzf | xargs nvim"
	alias dotsn="cd $XDG_CONFIG_HOME/nvim && nvim ."

	function nvim-clean-caches() {
		rm -rf "$HOME"/.local/share/nvim
		rm -rf "$HOME"/.local/state/nvim
		rm -rf "$HOME"/.cache/nvim
	}

fi

if command -v rg &>/dev/null; then
	alias grep='rg'
	alias ar='alias | rg'
fi

if command -v yadm &>/dev/null; then
	alias ya="yadm add"
	alias yaa="yadm add -u" #stage modified and deletions
	alias yg="cd && yadm enter lazygit && cd -"
	alias ys="yadm status -sb --ignore-submodules"
fi

# yazi - tui fm
if command -v yazi &>/dev/null; then

	alias y="yazi"

	# shell wrapper that will change to the selected directory on exit
	function ya() {
		local tmp="$(mktemp -t "yazi-cwd.XXXXX")"
		yazi "$@" --cwd-file="$tmp"
		if cwd="$(cat -- "$tmp")" && [ -n "$cwd" ] && [ "$cwd" != "$PWD" ]; then
			cd -- "$cwd"
		fi
		rm -f -- "$tmp"
	}
fi

# zoxide
if command -v zoxide &>/dev/null; then
	alias cd="z"
else
	alias z="cd"
fi

# machine specific aliases
if test -f $HOME/.aliasrc.local; then
	source $HOME/.aliasrc.local
fi
